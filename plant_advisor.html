<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Filter</title>
    <link rel="stylesheet" href="test.css">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;500;700&display=swap" rel="stylesheet">
</head>

<body style="margin-top: 180px;">
    <!--Header-->
    <header style="width: 100%; z-index: 1000; position: fixed; top: 0;">
        <div class="header">

            <!--Header logo-->
            <div
                style="display: flex; width: 10%; height: 100%; justify-content: center; align-items: center; flex-direction: column;">
                <div style="height:70%; text-align: center;">
                    <a href="./index.html">
                        <image style="width: 80%;" src="./image/Logo.png">
                    </a>
                </div>
                <div
                    style="height: 30%; text-align: center; color:#403323; font-weight: 500; font-size: 20px; font-family: 'Jost';">
                    Bulblos
                </div>
            </div>

            <!--Header menu-->
            <div class="header-menu" style="width: 85%;">
                <div><a href="./index.html">Home</a></div>
                <div><a href="./plant_library.html">Plant Library</a></div>
                <div><a href="./plant_advisor.html" class="active">Plant Advisor</a></div>
                <div><a href="./plant_identifier.html">Plant Identifier</a></div>
                <div><a href="./plant_doctor.html">Plant Doctor</a></div>
                <div><a href="./plant_disease_hub.html">Plant Disease Hub</a></div>
                <div><a href="./about_us.html">About Us</a></div>
            </div>
        </div>
    </header>

    <div
        style="display: flex; position: relative; align-items: center; justify-content: center; width: 100%; height: 300px; background-image: url(./image/WhatsApp\ Image\ 2024-04-25\ at\ 22.33.39.jpeg); flex-direction: column;">
        <div
            style="text-align: center; align-content: center;color: white; font-size: 30px; font-family: 'Jost'; font-weight: 300; word-wrap: break-word; padding-left: 10%; padding-right: 5%;">
            Our intuitive filtering options let you effortlessly sift through plants based on soil type, sun exposure
            preferences,
            and seasonal needs, ensuring you find your perfect green match.
        </div>
        <div
            style="text-align: center; align-content: center;color: white; font-size: 35px; font-family: 'Jost'; font-style: italic; font-weight: 400; word-wrap: break-word; padding-left: 10%; padding-right: 5%; margin-top: 3%;">
            Answer the question below and Bulblos will give you the perfect match!
        </div>

    </div>

    <div style="width: 100%; display: flex; position: relative; justify-content: center;">
        <div id="wizard">
            <!-- Step 1: Soil Type -->
            <div class="step active" id="step1">
                <div
                    style="width: 100%; text-align: center; color: #fcfce4; font-size: 25px; font-family: 'Jost'; font-weight: 300; word-wrap: break-word; margin-bottom: 30px;">
                    What type of soil do you have in your garden?
                </div>
                <div class="option-container" id="soilType">
                    <button class="option" value="Loam" onclick="selectOption('soilType', 'Loam')">
                        Loam
                        <span class="bubble">
                            Ideal for gardening, a balanced mix of sand, silt, and clay.
                        </span>
                    </button>
                    <button id="loam-clay" class="option" value="Loam,Clay"
                        onclick="selectOption('soilType', 'Loam,Clay')">Loam,Clay
                        <span class="bubble">
                            Mostly loam with added clay; good nutrient retention but may be heavy.
                        </span>
                    </button>
                    <button id="sand-loam" class="option" value="Sand,Loam"
                        onclick="selectOption('soilType', 'Sand,Loam')">Sand,Loam
                        <span class="bubble">
                            Predominantly loam with some sand; good drainage and nutrient retention.
                        </span>
                    </button>
                    <button id="sand-loam-clay" class="option" value="Sand,Loam,Clay"
                        onclick="selectOption('soilType', 'Sand,Loam,Clay')">Sand,Loam,Clay
                        <span class="bubble">
                            Mix of sand, loam, and clay; diverse properties, suitable for various plants.
                        </span>
                    </button>
                </div>
                <div style="display: flex; width: 100%; margin-top: 2%; justify-content: center;">
                    <button class="button-next" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 2: Sunlight Exposure -->
            <div class="step" id="step2">
                <div
                    style="width: 100%; text-align: center; color: #fcfce4; font-size: 25px; font-family: 'Jost'; font-weight: 300; word-wrap: break-word; margin-bottom: 30px;">
                    Is your garden mostly in shade or sunlight?
                </div>
                <div class="option-container" id="sunlightExposure">
                    <button class="option" value="Semi-shade"
                        onclick="selectOption('sunlightExposure', 'Semi-shade')">Semi-shade
                        <span class="bubble">
                            Some shade, but also receives some sunlight during the day.
                        </span>
                    </button>
                    <button class="option" value="Sun" onclick="selectOption('sunlightExposure', 'Sun')">Sun
                        <span class="bubble">
                            Direct sunlight for most of the day.
                        </span>
                    </button>
                    <button class="option" value="Sun,Semi-shade"
                        onclick="selectOption('sunlightExposure', 'Sun,Semi-shade')">Sun,Semi-shade
                        <span class="bubble">
                            Mix of both direct sunlight and some shade.
                        </span>
                    </button>
                </div>
                <div style="display: flex; width: 100%; margin-top: 2%; justify-content: center;">
                    <button class="button-previous" onclick="prevStep()">Previous</button>
                    <button class="button-next" onclick="nextStep()">Next</button>
                </div>
            </div>

            <!-- Step 3: Maintenance Level -->
            <div class="step" id="step3">
                <div
                    style="width: 100%; text-align: center; color: #fcfce4; font-size: 25px; font-family: 'Jost'; font-weight: 300; word-wrap: break-word; margin-bottom: 30px;">
                    Which level of plant maintenance suits you best?
                </div>
                <div class="option-container" id="maintenance">
                    <button class="option" value="Low" onclick="selectOption('maintenance', 'Low')">Low
                        <span class="bubble">
                            Plants that require minimal care and attention.
                        </span>
                    </button>
                    <button class="option" value="Medium" onclick="selectOption('maintenance', 'Medium')">Medium
                        <span class="bubble">
                            Plants that need some regular care and occasional attention.
                        </span>
                    </button>
                    <button class="option" value="High" onclick="selectOption('maintenance', 'High')">High
                        <span class="bubble">
                            Plants that need some regular care and occasional attention.
                        </span>
                    </button>
                </div>
                <div style="display: flex; width: 100%; margin-top: 2%; justify-content: center;">
                    <button class="button-previous" onclick="prevStep()">Previous</button>
                    <button class="button-submit" onclick="submitSelections()">
                        Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results -->
    <div id="information-tips"></div>

    <div id="results"></div>

    <div id="advisor-jumpBtn"></div>

    <!--footer-->
    <footer>
        <div
            style="width: 90%; height: 350px; position: relative; background: #783E19; border-top-right-radius: 140px; overflow: hidden">

            <!--footer menu-->
            <table class="footer-menu">
                <tr>
                    <td><a href="./index.html">Home</a></td>
                    <td><a href="./plant_disease_hub.html">Plant Disease Hub</a></td>
                </tr>
                <tr>
                    <td><a href="./about_us.html">About Us</a></td>
                    <td><a href="./plant_identifier.html">Plant Identifier</a></td>
                </tr>
                <tr>
                    <td><a href="./plant_library.html">Plant Library</a></td>
                </tr>
                <tr>
                    <td><a href="./plant_doctor.html">Plant Doctor</a></td>
                </tr>
                <tr>
                    <td><a href="./plant_advisor.html" class="active">Plant Advisor</a></td>
                </tr>
            </table>

            <!--Footer logo-->
            <div style="display: flex; width: 100%; position: relative; margin-top: 3%;">
                <div style="position: relative; width: 50%; left:5%;">
                    <span
                        style="color: white; font-size:23px; font-family:'Jost'; font-weight: 500; word-wrap: break-word">Bulblos
                    </span>
                    <span
                        style="color: white; font-size:23px; font-family:'Jost'; font-weight: 400; word-wrap: break-word">©
                        Marshmallows 2024
                    </span>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let currentStep = 1;
        let selections = {
            soilType: null,
            sunlightExposure: null,
            maintenance: null
        };

        function selectOption(optionType, value) {
            selections[optionType] = value;
            highlightSelected(optionType, value);
        }

        function highlightSelected(optionType, value) {
            const options = document.querySelectorAll(`#${optionType} .option`);
            options.forEach((option) => {
                option.classList.remove('selected');
            });
            document.querySelector(`#${optionType} .option[value='${value}']`).classList.add('selected');
        }

        function nextStep() {
            if (currentStep < 3) {
                currentStep++;
                updateStep();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStep();
            }
        }

        function updateStep() {
            const steps = document.querySelectorAll('.step');
            steps.forEach(step => step.classList.remove('active'));
            steps[currentStep - 1].classList.add('active');
        }

        function submitSelections() {
            if (selections.soilType && selections.sunlightExposure && selections.maintenance) {
                filterPlants();
            } else {
                alert("Please select options for all questions.");
            }
        }

        function filterPlants() {
            const apiUrl = 'https://render-api-2cxj.onrender.com/native_data';
            fetch(apiUrl, {
                method: 'GET',
            })
                .then(response => response.json())
                .then(data => {
                    // Filter plants
                    const filteredPlants = data.filter(plant =>
                        (plant['Soil Type'].includes(selections.soilType) || !selections.soilType) &&
                        (plant['Light Needs'].includes(selections.sunlightExposure) || !selections.sunlightExposure) &&
                        (plant['Maintenance'].includes(selections.maintenance) || !selections.maintenance)
                    );

                    // Display filtered results
                    displayResults(filteredPlants);

                    // Save filtered plants to localStorage
                    localStorage.setItem('filteredPlants', JSON.stringify(filteredPlants));
                })
                .catch(error => console.error('Error:', error));
        }
        function displayResults(data) {
            const resultsElement = document.getElementById('results');
            resultsElement.innerHTML = '';

            const tipsElement = document.getElementById('information-tips');
            tipsElement.innerHTML = '<div id="tipsElement" style="text-align: center; font-size: 26px; width: 70%; padding-left: 15%; padding-right: 15%; font-family: Jost;">Here are some plants perfect for your garden, considering your selected soil, sunlight, and maintenance preferences. Take a look and see which ones you like best!</div>';

            const jumpBtn = document.getElementById('advisor-jumpBtn')
            jumpBtn.innerHTML = `
                                <div style="text-align: center; font-size: 25px; font-family: 'Jost'; margin-top: 50px;">
                                    Want to learn about a plant, but don't know its name? Discover with our Plant Identifier.
                                </div>
                                <div style="text-align: center; margin-top: 50px; margin-bottom: 50px;">
                                    <a href="./plant_identifier.html">
                                        <button id="jumpBtn">
                                            Identify Unknown Plants Now!
                                        </button>
                                    </a>
                                </div>
                                `

            document.getElementById('tipsElement').scrollIntoView({ behavior: 'smooth' });

            let currentPage = 0;
            const plantsPerPage = 8; // Number of plants per page

            const filteredPlants = data.filter(plant =>
                (plant['Soil Type'].includes(selections.soilType) || !selections.soilType) &&
                (plant['Light Needs'].includes(selections.sunlightExposure) || !selections.sunlightExposure) &&
                (plant['Maintenance'].includes(selections.maintenance) || !selections.maintenance)
            );

            function renderPage() {
                if (filteredPlants.length > 0) {
                    const pagePlants = filteredPlants.slice(currentPage * plantsPerPage, (currentPage + 1) * plantsPerPage);
                    const plantCards = pagePlants.map(plant => `
                <a href="./plant_info.html?botanicalName=${encodeURIComponent(plant['Botanical Name'])}">
                    <div class="card">
                        <div class="image-container-modeling">
                            <img src="${plant['Image_Url']}" alt="${plant['Common Name']} Image" class="plant-image-modeling">
                        </div>
                        <div style="display: flex; justify-content: center; align-items: center; width: 100%; height: 30%; background-color: #403323;">
                            <div style="width: 90%; font-size: 20px; font-family: 'Jost'; color: #FFFFFF; text-align: center;">
                                ${plant['Botanical Name']}
                            </div>
                        </div>
                    </div>
                </a>
            `).join('');

                    resultsElement.innerHTML = `
                                        <div style ="position: relative; display: flex; width: 90%; height: 100%; justify-content: center; align-items: center; padding-left: 10%">
                                            <div style="position: relative;">
                                                ${plantCards}
                                            </div>
                                        </div>
                                        <div style="text-align:center; position: relative;">
                                            <button class="card-nav" onclick="navigate(-1)" ${currentPage === 0 ? 'disabled style="background-color: #ccc; cursor: not-allowed;"' : ''}>Previous page</button>
                                            <button class="card-nav" onclick="navigate(1)" ${currentPage * plantsPerPage + pagePlants.length >= filteredPlants.length ? 'disabled style="background-color: #ccc; cursor: not-allowed;"' : ''}>Next page</button>
                                        </div>`;
                } else {
                    resultsElement.innerHTML = '<div id="tipsElement" style="text-align: center; font-size: 26px; width: 70%; padding-left: 15%; padding-right: 15%; font-family: Jost;">No plants suitable. Try other options.</div>';

                }
            }

            function navigate(direction) {
                currentPage += direction;
                renderPage();
            }

            window.navigate = navigate;
            renderPage();
            localStorage.setItem('filteredPlants', JSON.stringify(filteredPlants));
        }


    </script>
</body>

</html>