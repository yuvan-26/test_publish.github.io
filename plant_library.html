<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Library</title>
    <link rel="stylesheet" href="test.css">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        html,
        body {
            height: 100%;
        }
    </style>
</head>

<body style="margin-top: 180px;">
    <div style="min-height: 100%; display: flex; flex-direction: column;">
        <!--Header-->
        <header style="width: 100%; z-index: 1000; position: fixed; top: 0;">
            <div class="header">

                <!--Header logo-->
                <div style="width: 40%;">
                    <a href="./index.html">
                        <image style="width: 25%;" src="./image/Logo.png">
                    </a>
                </div>

                <!--Header menu-->
                <div style="width: 60%;">
                    <table class="header-menu">
                        <tr>
                            <td><a href="./index.html">Home</a></td>
                            <td><a href="./plant_library.html" class="active">Plant Library</a></td>
                            <td><a href="./gardening_vitals.html">Gardening Vitals</a></td>
                            <td><a href="./gardening_modeling.html">Gardening Module</a></td>
                            <td><a href="./about_us.html">About Us</a></td>
                        </tr>
                    </table>
                </div>
            </div>
        </header>

        <div
            style="width: 100%; text-align: center; color: #121f0c; font-size: 50px; font-family: 'Jost'; font-weight: 500; word-wrap: break-word; margin-bottom: 40px;">
            Plant Library
        </div>
        <div
            style="width: 100%; text-align: center; color: #403323; font-size: 35px; font-family: 'Jost'; font-style: italic; font-weight: 400; word-wrap: break-word; margin-bottom: 50px;">
            Unearth the hidden gems of Victoria's native flora in our vibrant Plant Library.</div>
        <div style="width: 100%; position: relative; align-items: center; margin-left: 30px;">
            <div style="position: relative; align-items: center; justify-content: center; width: 100%;">
                <select id="plantSelect" onchange="displayPlantDetails()">
                    <option value="" class="default-option" selected>Select a Common Name</option>
                </select>

                <div id="plantDetails">
                    <!-- Placeholder for plant details -->
                </div>
            </div>
        </div>

        <script>
            // Declare the parsed variable outside the fetchPlantData function
            let parsed;

            // Function to fetch plant data from the backend API
            async function fetchPlantData() {
                try {
                    const response = await fetch('https://render-api-2cxj.onrender.com/plant_data');
                    const data = await response.json();

                    console.log(typeof data); // Check the type of data
                    parsed = JSON.parse(data); // Assign data to the parsed variable

                    // Check if data is an array
                    if (Array.isArray(parsed)) {
                        // Clear previous options
                        const plantSelect = document.getElementById('plantSelect');
                        plantSelect.innerHTML = '<option value="" class="default-option" selected>Select a Common Name</option>'; // Add default option
                        // Populate dropdown with common names
                        parsed.forEach(item => {
                            const option = document.createElement('option');
                            option.value = item['Common Name'];
                            option.textContent = item['Common Name'];
                            plantSelect.appendChild(option); // Append option to select element
                        });
                    } else {
                        throw new Error('No data received');
                    }
                } catch (error) {
                    console.error('Error fetching plant data:', error.message);
                    document.getElementById('plantSelect').innerHTML = '<option value="" class="default-option" selected>Error fetching data</option>';
                }
            }

            // Call fetchPlantData function when the page loads
            window.onload = fetchPlantData;

            // Function to display plant details
            function displayPlantDetails() {
                const selectedCommonName = document.getElementById('plantSelect').value;
                const plantDetailsContainer = document.getElementById('plantDetails');

                // Check if a common name is selected
                if (selectedCommonName) {
                    // Find the plant data corresponding to the selected common name
                    const selectedPlant = parsed.find(plant => plant['Common Name'] === selectedCommonName);

                    // Display the details in the plantDetailsContainer
                    if (selectedPlant) {
                        plantDetailsContainer.innerHTML = `
                        <div class="select-plant-box">
                            <div style="width: 40%; display: flex; justify-content: center; align-items: center; position: relative; flex-direction: column;">
                                <div style="width: 70%; text-align: center; color: #fcfce4; font-size: 35px; font-family: 'Jost'; font-weight: 500; word-wrap: break-word; margin-bottom: 3%;">
                                    ${selectedPlant['Common Name']}
                                </div>
                                <div class="image-container">
                                    <img src="${selectedPlant['Image Url']}" alt="${selectedPlant['Common Name']} Image" class="plant-image">
                                </div>
                            </div>
                            <div style="width: 60%; display: flex; justify-content: center; align-items: center;flex-direction: column; padding: 20px">
                                <div><strong>Botanical Name</strong>: ${selectedPlant['Botanical Name']}</div>
                                <div><strong>Plant Type</strong>: ${selectedPlant['Plant Type']}</div>
                                <div><strong>Water Needs</strong>: ${selectedPlant['Water Needs']}</div>
                                <div><strong>Maintenance</strong>: ${selectedPlant['Maintenance']}</div>
                                <div><strong>Climate Zones</strong>: ${selectedPlant['Climate Zones']}</div>
                                <div><strong>Abcission</strong>: ${selectedPlant['Abcission']}</div>
                                <div><strong>Height Ranges</strong>: ${selectedPlant['Height Ranges']}</div>
                            </div>
                        </div>
                        
                    `;
                    } else {
                        plantDetailsContainer.innerHTML = '<p>No details found for the selected plant</p>';
                    }
                } else {
                    plantDetailsContainer.innerHTML = '<p>Select a common name to view details</p>';
                }
            }
        </script>
        <!--footer-->
        <footer style="margin-top: auto;">
            <div
                style="display: flex; flex-direction: column; width: 90%; height: 350px; position: relative; background: #783E19; border-top-right-radius: 140px; overflow: hidden">

                <!--footer menu-->
                <table class="footer-menu">
                    <tr>
                        <td><a href="./index.html">Home</a></td>
                        <td><a href="#">Tools</a></td>
                    </tr>
                    <tr>
                        <td><a href="./about_us.html">About Us</a></td>
                        <td><a href="#">AI Plant Identifier</a></td>
                    </tr>
                    <tr>
                        <td><a href="./plant_library.html" class="active">Plant Library</a></td>
                        <td><a href="#">Plant Doctor</a></td>
                    </tr>
                    <tr>
                        <td><a href="./gardening_vitals.html">Gardening Vitals</a></td>
                        <td><a href="#">Floral Arrangements</a></td>
                    </tr>
                    <tr>
                        <td><a href="./gardening_modeling.html">Gardening Module</a></td>
                    </tr>
                </table>

                <!--Footer logo-->
                <div style="display: flex; width: 100%; position: relative; margin-top: 3%;">
                    <div style="position: relative; width: 50%; left:5%;">
                        <span
                            style="color: white; font-size:23px; font-family:'Jost'; font-weight: 500; word-wrap: break-word">Bulblos
                        </span>
                        <span
                            style="color: white; font-size:23px; font-family:'Jost'; font-weight: 400; word-wrap: break-word">Â©
                            Marshmallows 2024
                        </span>
                    </div>
                </div>
            </div>
        </footer>
    </div>
</body>

</html>